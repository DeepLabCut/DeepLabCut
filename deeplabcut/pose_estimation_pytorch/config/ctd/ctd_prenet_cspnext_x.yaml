data:
  bbox_margin: 25
  gen_sampling:
    keypoint_sigmas: 0.1
  inference:
    top_down_crop:
      width: 256
      height: 256
      crop_with_context: false
  train:
    top_down_crop:
      width: 256
      height: 256
      crop_with_context: false
method: ctd
model:
  backbone:
    type: CondPreNet
    backbone:
      type: CSPNeXt
      model_name: cspnext_x
      freeze_bn_stats: false
      freeze_bn_weights: false
      deepen_factor: 1.33
      widen_factor: 1.25
    kpt_encoder:
      type: ColoredKeypointEncoder
      num_joints: "num_bodyparts"
      kernel_size: [15, 15]
    img_size: [256, 256]
  backbone_output_channels: 1280
  heads:
    bodypart:
      type: HeatmapHead
      weight_init: normal
      predictor:
        type: HeatmapPredictor
        apply_sigmoid: false
        clip_scores: true
        location_refinement: true
        locref_std: 7.2801
      target_generator:
        type: HeatmapGaussianGenerator
        num_heatmaps: "num_bodyparts"
        pos_dist_thresh: 17
        heatmap_mode: KEYPOINT
        generate_locref: true
        locref_std: 7.2801
      criterion:
        heatmap:
          type: WeightedMSECriterion
          weight: 1.0
        locref:
          type: WeightedHuberCriterion
          weight: 0.05
      heatmap_config:
        channels:
        - 1280
        - "num_bodyparts"
        kernel_size: [3]
        strides: [2]
      locref_config:
        channels:
        - 1280
        - "num_bodyparts x 2"
        kernel_size: [3]
        strides: [2]
runner:
  optimizer:
    type: AdamW
    params:
      lr: 1e-05
  scheduler:
    type: LRListScheduler
    params:
      lr_list:
      - - 5e-04
      - - 1e-04
      - - 1e-05
      milestones:
      - 5
      - 90
      - 120
